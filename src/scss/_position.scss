@use 'variables' as v;

@mixin tooltip-hover {
  &:hover::before,
  &:hover::after,
  &.has-tooltip-active::before,
  &.has-tooltip-active::after {
    @content;
    visibility: visible;
    opacity: 1;
  }
}

@mixin vertical-positioned-tooltip($propertyY, $transitionDirection, $xDirection: 0) {
  &:after {
    margin-#{$propertyY}: calc(-1 * v.$tooltip-arrow-size);
  }

  &:before,
  &:after {
    #{$propertyY}: 100%;
    left: 50%;
  }

  &:after {
    left: calc(50% - #{v.$tooltip-arrow-size} / 2);
  }

  $translateX: -50%;
  @if $xDirection == -1 {
    $translateX: -100%;
  } @else if $xDirection == 1 {
    $translateX: 0;
  }

  &:before {
    transform: translateX($translateX);
    @if $xDirection != 0 {
      margin-left: -$xDirection * v.$tooltip-offset-x;
    }
  }

  &:hover {
    @include set-margin("translateY", $transitionDirection, $translateX);
  }
}

@mixin horizontal-positioned-tooltip($propertyX, $transitionDirection) {
  &:after {
    margin-#{$propertyX}: calc(-1 * v.$tooltip-arrow-size);
  }

  &:before {
    margin-bottom: calc(-1 * (v.$tooltip-font-size + 16px) / 2);
  }

  &:before,
  &:after {
    #{$propertyX}: 100%;
    bottom: 50%;
  }

  &:hover {
    @include set-margin("translateX", $transitionDirection);
  }
}

@mixin tooltip-direction($direction) {
  @if $direction == 'top' {
    &:after {
      border-color: v.$tooltip-background-color transparent transparent transparent;
    }
    @include vertical-positioned-tooltip("bottom", -1);
  } @else if $direction == 'bottom' {
    &:after {
      border-color: transparent transparent v.$tooltip-background-color transparent;
    }
    @include vertical-positioned-tooltip("top", 1);
  } @else if $direction == 'right' {
    &:after {
      border-color: transparent v.$tooltip-background-color transparent transparent;
    }
    @include horizontal-positioned-tooltip('left', 1);
  } @else if $direction == 'left' {
    &:after {
      border-color: transparent transparent transparent v.$tooltip-background-color;
    }
    @include horizontal-positioned-tooltip('right', -1);
  } @else if $direction == 'top-left' {
    &:after {
      border-color: v.$tooltip-background-color transparent transparent transparent;
    }
    @include vertical-positioned-tooltip('bottom', -1, -1);
  } @else if $direction == 'top-right' {
    &:after {
      border-color: v.$tooltip-background-color transparent transparent transparent;
    }
    @include vertical-positioned-tooltip('bottom', -1, 1);
  } @else if $direction == 'bottom-left' {
    &:after {
      border-color: transparent transparent v.$tooltip-background-color transparent;
    }
    @include vertical-positioned-tooltip('top', 1, -1);
  } @else if $direction == 'bottom-right' {
    &:after {
      border-color: transparent transparent v.$tooltip-background-color transparent;
    }
    @include vertical-positioned-tooltip('top', 1, 1);
  }
}

@mixin set-margin($property, $transitionDirection, $translateX: 0) {
  $value: #{$property}(#{v.$tooltip-animation-distance * $transitionDirection});

  &:after {
    transform: #{$value};
  }

  &:before {
    @if $translateX != 0 {
      transform: translateX($translateX) #{$value};
    } @else {
      transform: #{$value};
    }
  }
}
